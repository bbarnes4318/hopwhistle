<?xml version="1.0" encoding="UTF-8"?>
<!-- Verto Configuration for WebRTC Browser-Based Calling -->
<configuration name="verto.conf" description="Verto Module Configuration">
  <settings>
    <!-- Debug level (0-7, higher = more verbose) -->
    <param name="debug" value="0"/>

    <!-- Enable RTP timeout detection -->
    <param name="enable-3pcc" value="true"/>
  </settings>

  <profiles>
    <!-- WebSocket profile for browser connections -->
    <profile name="default-verto-profile">
      <!-- Bind to all interfaces on port 8082 for WebSocket -->
      <param name="bind-local" value="0.0.0.0:8082"/>

      <!-- Enable TLS for secure WebSocket (wss://) -->
      <param name="secure-combined" value="$${certs_dir}/tls.pem"/>
      <param name="secure-chain" value="$${certs_dir}/chain.pem"/>

      <!-- Or use non-secure WebSocket (ws://) for development -->
      <!-- <param name="force-register-domain" value="$${domain}"/> -->

      <!-- User directory for verto auth -->
      <param name="userauth" value="true"/>

      <!-- Allow inbound calls to verto clients -->
      <param name="inbound-codec-string" value="opus,PCMU,PCMA"/>
      <param name="outbound-codec-string" value="opus,PCMU,PCMA"/>

      <!-- Apply dialplan context -->
      <param name="apply-candidate-acl" value="rfc1918.auto"/>
      <param name="local-network-acl" value="rfc1918.auto"/>

      <!-- RTP ports -->
      <param name="rtp-ip" value="$${local_ip_v4}"/>
      <param name="ext-rtp-ip" value="$${external_rtp_ip}"/>

      <!-- STUN server for NAT traversal -->
      <param name="ext-rtp-ip" value="stun:stun.l.google.com:19302"/>

      <!-- Dialplan context for verto calls -->
      <param name="context" value="default"/>

      <!-- Timer values -->
      <param name="timer-T1" value="500"/>
      <param name="timer-T1X64" value="32000"/>
      <param name="timer-T2" value="4000"/>
      <param name="timer-T4" value="5000"/>

      <!-- Enable/Disable ICE -->
      <param name="use-ice" value="true"/>

      <!-- Auto-allocate RTP ports -->
      <param name="rtp-start-port" value="16384"/>
      <param name="rtp-end-port" value="32768"/>
    </profile>

    <!-- Non-secure WebSocket profile for local development -->
    <profile name="dev-verto-profile">
      <param name="bind-local" value="0.0.0.0:8083"/>
      <param name="userauth" value="true"/>
      <param name="inbound-codec-string" value="opus,PCMU,PCMA"/>
      <param name="outbound-codec-string" value="opus,PCMU,PCMA"/>
      <param name="context" value="default"/>
      <param name="use-ice" value="true"/>
      <param name="rtp-ip" value="$${local_ip_v4}"/>
      <param name="ext-rtp-ip" value="$${external_rtp_ip}"/>
      <param name="apply-candidate-acl" value="rfc1918.auto"/>
    </profile>
  </profiles>
</configuration>
